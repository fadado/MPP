#!/bin/sh

# mpp - Markdown preprocessor

readonly PRELUDE="share/_prelude.mpp"
readonly INCLUDE="./share"
readonly ENVIRON="-DUID=$UID -DHOME=$HOME -DPWD='$PWD' -DLANG=$LANG -DPID=$$"

exec gpp \
    -U '<%' '\W>' '\B' '\B' '\W>' '<' '>' '$' '' \
    +sccc '&\n' '' ''           \
    +siic '<#' '#>' ''          \
    +siqi "'" "'" ''            \
    +siQi '"' '"' ''            \
    +siis '<!--' '-->' ''       \
    +siis '`'  '`' ''           \
    +siis '\n```' '\n```' ''    \
    +siis '\n~~~' '\n~~~' ''    \
    -x -m                       \
    --warninglevel 2            \
    --nostdinc                  \
    -I "$INCLUDE"               \
    --include "$PRELUDE"        \
    $ENVIRON                    \
    "$@"

# no reached
exit 1

# vim:ts=4:sw=4:ai:et:fileencoding=utf-8:syntax=sh
